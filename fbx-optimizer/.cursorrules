# Cursor Rules for FBX Optimizer Project

## ğŸ“‹ å°ˆæ¡ˆæ¦‚è¿°
é€™æ˜¯ä¸€å€‹åŸºæ–¼ React + TypeScript + Three.js çš„ 3D æ¨¡å‹æª¢è¦–èˆ‡å„ªåŒ–å·¥å…·ï¼Œæ¡ç”¨ Domain-Driven Design (DDD) å•Ÿç™¼çš„åˆ†å±¤æ¶æ§‹ã€‚

---

## ğŸ—ï¸ æ¶æ§‹é™åˆ¶

### åˆ†å±¤æ¶æ§‹è¦å‰‡

1. **Domain Layer (`src/domain/`)**
   - âœ… åªèƒ½åŒ…å«ç´”æ¥­å‹™é‚è¼¯
   - âŒ ç¦æ­¢ä¾è³´ Reactã€Three.js ç­‰å¤–éƒ¨æ¡†æ¶
   - âŒ ç¦æ­¢ä¾è³´ Applicationã€Infrastructureã€Presentation å±¤
   - âœ… å¯ä»¥ä¾è³´ TypeScript æ¨™æº–åº«å’Œ Three.js é¡å‹å®šç¾©ï¼ˆåƒ…é¡å‹ï¼‰

2. **Application Layer (`src/application/`)**
   - âœ… å¯ä»¥ä¾è³´ Domain å±¤
   - âœ… å¯ä»¥ä¾è³´ Infrastructure å±¤
   - âŒ ç¦æ­¢ä¾è³´ Presentation å±¤
   - âœ… Use Cases æ‡‰ç‚ºéœæ…‹æ–¹æ³•ï¼Œå‘½åç‚º `execute()`

3. **Infrastructure Layer (`src/infrastructure/`)**
   - âœ… å¯ä»¥ä¾è³´ Domain å±¤ï¼ˆå¯¦ç¾ Domain å®šç¾©çš„ä»‹é¢ï¼‰
   - âŒ ç¦æ­¢ä¾è³´ Applicationã€Presentation å±¤
   - âœ… å°è£å¤–éƒ¨ APIï¼ˆWeb Audio APIã€Three.js Loaders ç­‰ï¼‰

4. **Presentation Layer (`src/presentation/`)**
   - âœ… å¯ä»¥ä¾è³´ Application å±¤ï¼ˆé€é Use Casesï¼‰
   - âœ… å¯ä»¥ä¾è³´ Domain å±¤ï¼ˆä½¿ç”¨ Value Objectsï¼‰
   - âŒ ç¦æ­¢ç›´æ¥ä¾è³´ Infrastructure å±¤ï¼ˆæ‡‰é€é Use Casesï¼‰
   - âœ… React çµ„ä»¶æ‡‰æ”¾åœ¨ `features/` ä¸‹ï¼ŒæŒ‰åŠŸèƒ½æ¨¡çµ„çµ„ç¹”

### æª”æ¡ˆçµ„ç¹”è¦å‰‡

- âœ… æ¯å€‹åŠŸèƒ½æ¨¡çµ„æ”¾åœ¨ `presentation/features/[feature-name]/components/` ä¸‹
- âœ… å…±ç”¨ Hooks æ”¾åœ¨ `presentation/hooks/` ä¸‹
- âœ… å·¥å…·å‡½æ•¸æŒ‰é¡åˆ¥çµ„ç¹”åœ¨ `utils/[category]/` ä¸‹
- âŒ ç¦æ­¢åœ¨ `src/components/` æ ¹ç›®éŒ„æ”¾ç½®æ–°æª”æ¡ˆï¼ˆå·²å»¢æ£„ï¼‰
- âœ… Use Cases æ”¾åœ¨ `application/use-cases/` ä¸‹
- âœ… Domain Services æ”¾åœ¨ `domain/services/` ä¸‹
- âœ… Value Objects æ”¾åœ¨ `domain/value-objects/` ä¸‹

---

## ğŸ“ å‘½åè¦å‰‡

### è®Šæ•¸å‘½å
- **camelCase**ï¼šè®Šæ•¸ã€å‡½æ•¸åƒæ•¸
  - âœ… `currentTime`ã€`audioTracks`ã€`meshNames`
  - âŒ `CurrentTime`ã€`audio_tracks`ã€`mesh_names`

- **UPPER_CASE**ï¼šå¸¸æ•¸ï¼ˆçœŸæ­£çš„å¸¸æ•¸å€¼ï¼‰
  - âœ… `SAMPLE_RATE`ã€`MP3_SAMPLE_BLOCK_SIZE`
  - âŒ `sampleRate`ï¼ˆå¦‚æœæ˜¯è®Šæ•¸ï¼‰

- **PascalCase**ï¼šé¡åˆ¥ã€ä»‹é¢ã€é¡å‹ã€React çµ„ä»¶
  - âœ… `AnimationOptimizer`ã€`LoadModelResult`ã€`SceneViewer`

### å‡½æ•¸å‘½å
- **å‹•è©é–‹é ­**ï¼šæ¸…æ¥šè¡¨é”å‡½æ•¸è¡Œç‚º
  - âœ… `loadModel()`ã€`exportAudio()`ã€`createSubClip()`ã€`countKeyframes()`
  - âŒ `model()`ã€`audio()`ã€`clip()`ã€`keyframes()`

- **Use Cases**ï¼šéœæ…‹æ–¹æ³•å‘½åç‚º `execute()`
  - âœ… `LoadModelUseCase.execute()`
  - âŒ `LoadModelUseCase.load()`ã€`LoadModelUseCase.run()`

- **Hooks**ï¼šå¿…é ˆä»¥ `use` é–‹é ­
  - âœ… `useTheme()`ã€`useFileDrop()`ã€`usePanelResize()`
  - âŒ `theme()`ã€`fileDrop()`ã€`panelResize()`

- **Services**ï¼šæ–¹æ³•æ‡‰ç‚ºå‹•è©
  - âœ… `optimize()`ã€`fixMaterials()`ã€`loadFBX()`
  - âŒ `optimization()`ã€`materialFix()`ã€`fbxLoader()`

### æª”æ¡ˆå‘½å
- **çµ„ä»¶æª”æ¡ˆ**ï¼šPascalCase + `.tsx`
  - âœ… `SceneViewer.tsx`ã€`AudioPanel.tsx`
  - âŒ `sceneViewer.tsx`ã€`audio-panel.tsx`

- **å·¥å…·å‡½æ•¸æª”æ¡ˆ**ï¼šcamelCase + `Utils` å¾Œç¶´ + `.ts`
  - âœ… `arrayUtils.ts`ã€`textureLoaderUtils.ts`
  - âŒ `ArrayUtils.ts`ã€`texture-loader-utils.ts`

- **Use Cases**ï¼šPascalCase + `UseCase` å¾Œç¶´ + `.ts`
  - âœ… `LoadModelUseCase.ts`ã€`ExportModelUseCase.ts`
  - âŒ `loadModelUseCase.ts`ã€`LoadModel.ts`

- **Services**ï¼šPascalCase + `Service` å¾Œç¶´ + `.ts`
  - âœ… `ModelLoaderService.ts`ã€`AnimationOptimizer.ts`
  - âŒ `modelLoaderService.ts`ã€`ModelLoader.ts`

- **Hooks**ï¼šcamelCase + `use` å‰ç¶´ + `.ts`
  - âœ… `useTheme.ts`ã€`useFileDrop.ts`
  - âŒ `UseTheme.ts`ã€`theme.ts`

### é¿å…çš„å‘½å
- âŒ æ¨¡ç³Šçš„è®Šæ•¸åï¼š`data`ã€`temp`ã€`obj`ã€`result`
- âœ… ä½¿ç”¨æ¥­å‹™æ„ç¾©æ˜ç¢ºçš„åç¨±ï¼š`loadModelResult`ã€`audioTrack`ã€`shaderGroup`

- âŒ å–®å­—æ¯è®Šæ•¸ï¼š`i`ã€`j`ã€`k`ã€`t`ã€`f`
- âœ… ä½¿ç”¨æè¿°æ€§åç¨±ï¼š`currentKeyframeIndex`ã€`textureLoader`ã€`audioFile`

---

## ğŸ’» ç¨‹å¼ç¢¼é¢¨æ ¼

### TypeScript
- âœ… ä½¿ç”¨æ˜ç¢ºçš„é¡å‹è¨»è§£ï¼ˆé¿å… `any`ï¼‰
- âœ… ä½¿ç”¨ `interface` å®šç¾©ç‰©ä»¶çµæ§‹
- âœ… ä½¿ç”¨ `type` å®šç¾©è¯åˆé¡å‹ã€åˆ¥å
- âœ… ä½¿ç”¨ `const` å®£å‘Šå¸¸æ•¸ï¼Œ`let` å®£å‘Šè®Šæ•¸ï¼ˆé¿å… `var`ï¼‰

### React
- âœ… ä½¿ç”¨å‡½æ•¸çµ„ä»¶ï¼ˆFunction Componentsï¼‰
- âœ… ä½¿ç”¨ Hooks ç®¡ç†ç‹€æ…‹å’Œå‰¯ä½œç”¨
- âœ… Props ä½¿ç”¨ `interface` å®šç¾©é¡å‹
- âœ… ä½¿ç”¨ `forwardRef` æš´éœ²çµ„ä»¶ API
- âœ… ä½¿ç”¨ `useCallback`ã€`useMemo` å„ªåŒ–æ€§èƒ½ï¼ˆç•¶éœ€è¦æ™‚ï¼‰

### å‡½æ•¸å¼ç¨‹å¼è¨­è¨ˆ
- âœ… å„ªå…ˆä½¿ç”¨ä¸å¯è®Šæ›´æ–°ï¼ˆä¸ç›´æ¥ä¿®æ”¹é™£åˆ—/ç‰©ä»¶ï¼‰
- âœ… ä½¿ç”¨å·¥å…·å‡½æ•¸ï¼ˆ`updateArrayItemById`ã€`updateShaderGroupById`ï¼‰é€²è¡Œæ›´æ–°
- âœ… ä½¿ç”¨ Guard Clauses å’Œ Early Return ç°¡åŒ–é‚è¼¯
- âŒ é¿å…æ·±å±¤åµŒå¥—çš„ if/else

### éŒ¯èª¤è™•ç†
- âœ… ä½¿ç”¨ `try-catch` è™•ç†ç•°æ­¥æ“ä½œ
- âœ… åœ¨ Use Cases ä¸­æ‹‹å‡ºæœ‰æ„ç¾©çš„éŒ¯èª¤è¨Šæ¯
- âœ… åœ¨ UI å±¤é¡¯ç¤ºç”¨æˆ¶å‹å¥½çš„éŒ¯èª¤è¨Šæ¯

---

## ğŸ“š æ–‡æª”è¨»é‡‹è¦ç¯„

### JSDoc/TSDoc æ ¼å¼
æ‰€æœ‰ Public Function å’Œ Class å¿…é ˆåŒ…å«å®Œæ•´çš„ JSDoc è¨»é‡‹ï¼š

```typescript
/**
 * å‡½æ•¸/é¡åˆ¥çš„ç°¡çŸ­æè¿°
 * 
 * è©³ç´°èªªæ˜ï¼ˆå¦‚æœéœ€è¦ï¼‰
 * 
 * @param paramName - åƒæ•¸èªªæ˜
 * @param paramName2 - åƒæ•¸èªªæ˜
 * @returns è¿”å›å€¼èªªæ˜
 * @throws {Error} å¯èƒ½çš„éŒ¯èª¤æƒ…æ³
 * 
 * @example
 * ```typescript
 * const result = functionName(param1, param2);
 * ```
 */
```

### å¿…é ˆåŠ ä¸Šæ–‡æª”çš„é …ç›®
- âœ… æ‰€æœ‰ Public Classes
- âœ… æ‰€æœ‰ Public Methodsï¼ˆåŒ…æ‹¬ Use Cases çš„ `execute()`ï¼‰
- âœ… æ‰€æœ‰ Public Functionsï¼ˆUtilsã€Hooksï¼‰
- âœ… æ‰€æœ‰ Public Interfacesï¼ˆValue Objectsï¼‰
- âŒ Private Methods å¯ä»¥çœç•¥ï¼ˆä½†å»ºè­°åŠ ä¸Šï¼‰

---

## ğŸ”§ é‡æ§‹åŸå‰‡

### å–®ä¸€è·è²¬åŸå‰‡ (SRP)
- âœ… æ¯å€‹é¡åˆ¥/å‡½æ•¸åªè² è²¬ä¸€ä»¶äº‹
- âœ… å°‡è¤‡é›œé‚è¼¯æ‹†åˆ†æˆå¤šå€‹å°å‡½æ•¸
- âœ… æ¥­å‹™é‚è¼¯ç§»è‡³ Use Cases æˆ– Services
- âœ… UI é‚è¼¯ç§»è‡³ Hooks

### DRY (Don't Repeat Yourself)
- âœ… æå–é‡è¤‡é‚è¼¯ç‚ºå…±ç”¨å‡½æ•¸
- âœ… ä½¿ç”¨å·¥å…·å‡½æ•¸é¿å…é‡è¤‡çš„æ›´æ–°æ¨¡å¼
- âœ… å…±ç”¨çµ„ä»¶æ”¾åœ¨ `presentation/features/shared/` ä¸‹

### å¯è®€æ€§
- âœ… ä½¿ç”¨ Guard Clauses å’Œ Early Return
- âœ… é¿å…æ·±å±¤åµŒå¥—ï¼ˆå»ºè­°ä¸è¶…é 3 å±¤ï¼‰
- âœ… ä½¿ç”¨æœ‰æ„ç¾©çš„è®Šæ•¸å
- âœ… è¤‡é›œé‚è¼¯åŠ ä¸Šè¨»é‡‹èªªæ˜

---

## ğŸš« ç¦æ­¢äº‹é …

1. âŒ åœ¨ Domain å±¤ä½¿ç”¨ React Hooks æˆ– Three.js ç‰©ä»¶
2. âŒ åœ¨ Presentation å±¤ç›´æ¥å‘¼å« Infrastructure å±¤çš„æ–¹æ³•
3. âŒ ä½¿ç”¨ `any` é¡å‹ï¼ˆé™¤éçµ•å°å¿…è¦ï¼‰
4. âŒ ç›´æ¥ä¿®æ”¹ props æˆ–ç‹€æ…‹ï¼ˆä½¿ç”¨ä¸å¯è®Šæ›´æ–°ï¼‰
5. âŒ åœ¨çµ„ä»¶ä¸­å¯«å…¥è¤‡é›œçš„æ¥­å‹™é‚è¼¯ï¼ˆæ‡‰ç§»è‡³ Use Casesï¼‰
6. âŒ ä½¿ç”¨æ¨¡ç³Šçš„è®Šæ•¸åï¼ˆ`data`ã€`temp`ã€`obj`ï¼‰
7. âŒ åœ¨ `src/components/` æ ¹ç›®éŒ„å»ºç«‹æ–°æª”æ¡ˆ

---

## âœ… æœ€ä½³å¯¦è¸

1. **ç‹€æ…‹ç®¡ç†**
   - ä½¿ç”¨ React `useState`ã€`useRef` ç®¡ç†æœ¬åœ°ç‹€æ…‹
   - è¤‡é›œæ¥­å‹™é‚è¼¯é€é Use Cases è™•ç†
   - UI é‚è¼¯å°è£åœ¨è‡ªè¨‚ Hooks ä¸­

2. **éŒ¯èª¤è™•ç†**
   - Use Cases æ‹‹å‡ºæœ‰æ„ç¾©çš„éŒ¯èª¤
   - UI å±¤æ•ç²éŒ¯èª¤ä¸¦é¡¯ç¤ºå‹å¥½è¨Šæ¯

3. **æ€§èƒ½å„ªåŒ–**
   - ä½¿ç”¨ `useCallback` åŒ…è£äº‹ä»¶è™•ç†å‡½æ•¸ï¼ˆç•¶ä½œç‚º props å‚³éæ™‚ï¼‰
   - ä½¿ç”¨ `useMemo` å¿«å–æ˜‚è²´è¨ˆç®—ï¼ˆç•¶éœ€è¦æ™‚ï¼‰
   - ä½¿ç”¨ `React.memo` å„ªåŒ–çµ„ä»¶æ¸²æŸ“ï¼ˆç•¶éœ€è¦æ™‚ï¼‰

4. **é¡å‹å®‰å…¨**
   - ç‚ºæ‰€æœ‰å‡½æ•¸åƒæ•¸å’Œè¿”å›å€¼åŠ ä¸Šé¡å‹è¨»è§£
   - ä½¿ç”¨ `interface` å®šç¾©è¤‡é›œç‰©ä»¶çµæ§‹
   - é¿å…ä½¿ç”¨ `any`ï¼Œå„ªå…ˆä½¿ç”¨ `unknown` æˆ–å…·é«”é¡å‹

5. **æ¸¬è©¦æº–å‚™**
   - Domain å±¤æ‡‰æ˜“æ–¼å–®å…ƒæ¸¬è©¦ï¼ˆç„¡å¤–éƒ¨ä¾è³´ï¼‰
   - Use Cases æ‡‰æ˜“æ–¼æ¸¬è©¦ï¼ˆå¯æ³¨å…¥ä¾è³´ï¼‰

---

## ğŸ“– åƒè€ƒæª”æ¡ˆ

- **å°ˆæ¡ˆä¸Šä¸‹æ–‡**ï¼š`PROJECT_CONTEXT.md` - å®Œæ•´çš„å°ˆæ¡ˆæŠ€è¡“æ–‡æª”
- **æ¶æ§‹èªªæ˜**ï¼šè¦‹ `PROJECT_CONTEXT.md` çš„ã€Œæ¶æ§‹è¨­è¨ˆã€ç« ç¯€

---

**æœ€å¾Œæ›´æ–°**ï¼š2024å¹´ï¼ˆé‡æ§‹å¾Œï¼‰



